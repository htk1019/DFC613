## 5강 퀀트포트폴리오 구성

### 소개
퀀트 주식 포트폴리오 운용(이하 QEPM, Quantitative Equity Portfolio Management)을 하는 매니저는 주식 수익률과 위험을 예측하기 위해 모델을 만들고 이런 예측에 기반하여 포트폴리오에 담을 주식을 선택합니다.

실무에서는 어떻게 하는지 많이들 궁금해 합니다. 

많은 회사들에는 사전에 패키징된 우수한 상용 소프트웨어를 사용하는 경우가 많습니다.
다만 퀀트 매니저라면 전적으로 상용 소프트웨어에 의존해서는 안됩니다. 사용 가능한 더 많은 정보를 사용하지 못하고 제공 받는 정보만 활용하게 되기 때문입니다. 포트폴리오 관리자가 '창의적'이 되려면 자신이 직접 계산한 결과와 사전 패키징된 상용 소프트웨어의 모델을 결합할 줄 알아야 합니다.
우수한 퀀트 매니저는 소프트웨어로 수행할 작업과 수행하지 말아야 할 작업을 잘 구분합니다.

실무에서 사용하는 QEPM에는 두 가지 모델이 있습니다. 우리는 이 두 가지 기본 모델에 대해 알아보는 것으로 이번 장을 시작합니다.
한가지 모델은 학계에서 사용하는 모델로 우리가 이미 배웠습니다. 다른 하나는 학계보다는 실무에서 더 많이 사용하는 형식으로 이제 배울 차례입니다.

### QEPM의 모델과 포트폴리오 구성 절차

QEPM에는 주식 수익률과 위험이 팩터에 따라 어떻게 달라지는지를 결정하는데 사용되는 두가지 종류의 팩터 모델이 있습니다. 그것은 펀더멘털 팩터 모델과 이코노믹 팩터 모델입니다. 모델은 일반적으로 그것이 주로 사용하는 팩터에서 이름을 가져왔습니다.

펀더멘털 팩터 모델은 PER, 시가총액 등 주식의 고유 특성인 펀더멘털 팩터를 사용합니다. 이코노믹 팩터 모델은 원래 국내 총생산(GDP), 인플레이션(CPI) 등 거시 경제변수를 사용할수도 있고 펀더멘털 팩터도 사용 가능합니다. 학계에서 사용하는 방식은 주로 이코노믹 팩터 모델이고 우리가 앞서 살펴본 팩터 모델링은 이코노믹팩터 모델에 가깝습니다.

펀더멘털 팩터 모델과 이코노믹 팩터 모델 모두 주식의 평균 수익률은 팩터 프리미엄과 팩터 익스포저의 곱에 의해 결정된다는 원칙에 기반하고 공식은 정확히 일치합니다.

$$r_i = \alpha_i + \beta_{i1}f_i+...+\beta_{ik}f_k + \epsilon_i$$

이코노믹 팩터 모델에서 팩터 프리미엄은 투자자들이 각 팩터에 대해 얼마를 지불할 용이가 있는지를 측정하는 반면, 팩터 익스포져는 주식 수익률이 팩터에 얼마나 민감한지를 측정합니다. 펀더멘털 팩터 모델에서는 조금 다르게 설명합니다.

펀더멘털 팩터 모델에서 팩터 노출도(Factor Exposure)는 바로 알 수 있는 값입니다. 하지만 이코노믹 팩터 모델에서는 추정해야 하는 값입니다. 반대로 팩터 프리미엄(Factor Premium)은 이코노믹 팩터 모델에서는 바로 확인 가능하지만 펀더멘털 팩터 모델 에서는 추정해야 하는 값입니다. 
왜 그런지는 다음 챕터에서 설명하겠습니다. 일단은 두 모델 모두 그 형태가 동일하다는 것만 기억하고 이제 다음으로 넘어가겠습니다.

일단 우리는 팩터 노출도와 팩터 프리미엄에 대한 정의를 좀 더 자세히 살펴볼 필요가 있습니다.

![](/pic/2023-08-17-17-51-58.png)

*결국 기대수익률과 위험을 표현하는 형식은 같습니다.*

### 팩터 선택

퀀트 포트폴리오를 구축하기 위한 팩터 선택에서 첫 번째 단계는 설명력이 높은 팩터를 선택하는 것입니다. 모든 퀀트 포트폴리오 매니저는 다양한 자신만의 팩터 조합을 사용합니다.

#### 데이터 결정

모델의 데이터 셋에 대한 선택은 팩터의 유형과 만들고 싶은 팩터 세트에 의해 결정됩니다. 데이터 셋은 횡단면 차원과 시계열 차원 두가지 차원으로 구성됩니다. 횡단면 차원은 주식의 유니버스를 말합니다. 특정 산업의 주식, S&P 500에 포함된 주식, 뉴욕증권거래소에 상장된 모든 주식, KOSPI 대형주식, 46개국 4000여개 주식(MSCI ACWI) 등을 결정합니다.

시계열 차원은 데이터의 주기성(즉 데이터 포인트가 기록된 시간 간격)과 전체 데이터 셋의 기간과 관련 됩니다. 데이터는 매분, 매일, 매주, 분기별로 기록될 수 있습니다. 전체 데이터 셋은 단 1년 (보통 파생쪽) 에서 수십년 (일반적으로 주식) 등 다양하게 구성됩니다.

데이터의 주기성과 기간은 분석된 모델의 매개변수 안정성과 불확실성에 영향을 미칩니다. 기간이 길고 촘촘할수록 신뢰도가 높아지는 편입니다.

#### 팩터 노출도 계산

팩터를 선택하고 데이터 셋을 정의하면 팩터 노출도와 팩터 프리미엄을 계산할 수 있습니다.
팩터 노출도는 팩터 로딩(Factor Loading)으로 불리기도 합니다.

펀더멘털 팩터 모델에서 팩터 노출도를 결정하는 것은 매우 간단합니다. 팩터가 B/P(PBR의 역수)인 경우 i라는 주식의 팩터 노출도는 B/P 의 최신 값 그 자체가 됩니다. 
K개의 팩터를 선택했다고 가정하면 모델은 다음과 같이 표현됩니다.

$$r_i = \alpha_i + \beta_{i1}f_i+...+\beta_{ik}f_k + \epsilon_i$$

여기서 앞에서 선택한 B/P는 $\beta_{ij}$가 됩니다. 

이코노믹 팩터 모델에서는 팩터 노출도를 직접 관찰할 수 없습니다.
대신 팩터 프리미엄을 확인할 수 있습니다. 예를들어 GDP같은 경제지표를 사용한다고 하면 $f_j$는 실질 GDP 성장률 같은 지표값이 될 수 있습니다. 한 주식의 수익률과 $f_j$간의 시계열 회귀분석을 하면 한 주식의 GDP 성장률에 대한 팩터 노출도를 계산할 수 있습니다.
이렇게 추정된 팩터 노출도가 $\beta_{ij}$ 값이 됩니다.

두 모델의 차이가 이해 되시나요?

#### 팩터 프리미엄 계산

팩터 프리미엄은 팩터가 나타내는 모든 위험에 대한 노출에 대해 시장이 부과하는 프리미엄을 뜻합니다. 팩터 리턴(Factor Return)이라고 불리기도 합니다.

펀더멘털 팩터 모델에서 B/P 팩터를 선택했다고 하면 우리는 한 단위의 B/P에 대한 팩터 프리미엄을 계산해야 합니다. 펀더멘털 팩터 모델에서 팩터 프리미엄은 분석 유니버스에 포함된 모든 주식에 대한 횡단면 회귀를 통해 추정됩니다. 만약 여러 시점의 횡단면을 사용하면 패널 회귀분석이라고도 합니다. 
모든 주식의 수익률과 B/P 팩터를 회귀분석 하여 B/P 한단위 크기 변화가 수익률에 얼마나 프리미엄을 제공하는 지를 확인하는 것입니다.

이코노믹 팩터 모델에서는 팩터 프리미엄이 먼저 결정됩니다. 거시 경제 요인을 팩터로 선택하면 팩터 자체의 값이 팩터 프리미엄으로 간주됩니다. 예를들어 이번달 인플레이션율이 3%라면 팩터 프리미엄 값은 3%입니다.
그런데 정확한 팩터 프리미엄 값은 3%가 아닌 3%에 비례하는 값입니다. 투자자들이 인플레이션에 노출된 주식의 노출도 한 단위당 3%를 지불한다는 의미로 해석되면 안됩니다. 그러나 실제 프리미엄은 물가 상승률의 상수배이므로 그대로 사용해서 모델링을 해도 됩니다.

만약 이코노믹 팩터 모델에서 B/P도 쓰고 인플레이션도 쓰고 하고 싶다면 어떻게 해야 할까요? 이 유형의 모델중 대표적인 모델이 FAMA-FRENCH 3 팩터 모델입니다.

HML과 SMB는 BookToMarket과 Size 같은 기업 고유의 특성과 시장수익률 같은 경제지표적 특성을 가진 지표가 조합된 형식입니다.
이떄 HML과 SMB는 무투자 포트폴리오의 수익률입니다. 무투자 포트폴리오는 가상의 투자자가 자본을 투자하지 않고 $100 어치의 주식을 공매도하여 $100 어치의 주식을 매수하여 구성한 포트폴리오 입니다. HML은 BookToMarket 지표값이 높은 주식을 매수하고 낮은 주식을 공매도 하여 구성한 포트폴리오의 수익률인 것입니다. 믁 무투자 포트폴리오에 대한 수익률을 계산하여 팩터 프리미엄을 결정할 수 있는 것입니다. 팩터 프리미엄의 다른 이름이 팩터 리턴인 이유가 있습니다.

{팩터 노출도,팩터 프리미엄}, {팩터 로딩, 팩터 리턴} 쌍으로 다양한 책에서 혼용되어 사용되어 헷깔린다는 의견을 많이 들었습니다. 이는 모델을 바라보는 관점에 따라 다른 것입니다.


#### 기대수익률 계산

펀더멘털 팩터모델이든 이코노믹 팩터모델이든 모든 모델의 주식예 예상 수익률 계산식은 동일합니다.

$$r_i = \alpha_i + \beta_{i1}f_i+...+\beta_{ik}f_k + \epsilon_i$$

#### 위험 계산

주식의 모델은 주식의 위험에 대한 중요한 정보를 제공합니다. 추정된 위험은 분산 불가능한 위험과 분간 가능한 위험 두 가지로 분해됩니다.
분산 불가능한 위험은 식에서 $\alpha_i + \beta_{i1}f_i+...+\beta_{ik}f_k $로 표시됩니다. 반면에 분간 가능한 위험은 보유 자산을 분산하여 포트폴리오에서 제거할 수 있습니다. 위험 파트는 뒤에서 더 자세하게 알아볼 것입니다.

#### 예측

주식의 기대수익률은 단순히 팩터 프리미엄과 팩터 노출도의 곱입니다. 문제는 모델의 팩터 프리미엄과 팩터 노출이 과거 데이터를 통해서 결정된다는 점입니다. 수익률, 노출도, 프리미엄은 미래에 변할 가능성이 높습니다. 퀀트 운용역은 과거가 아닌 미래를 알고 싶어합니다. 이 주제도 뒤에서 더 자세하게 알아볼 것입니다.
미리 결론을 말해보면 팩터 노출도는 가까운 미래에 자주 변하지 않습니다. 하지만 팩터 프리미엄은 아주 단기간에도 변하곤 합니다.

#### 주식 비중 결정

예측된 기대수익률과 위험을 통해 포트폴리오 관리자는 개별 자산의 비중을 결정할 수 있습니다. 보통 최적화 기술을 사용하여 가중치를 할당합니다.
포트폴리오에 포함된 주식의 가중치는 포트폴리오의 수익률을 최대화 하고 위험을 최소화 하도록 결정되지만 절대적으로 지켜야 하는 각종 제약조건 하에서 진행됩니다.
이런 제약조건들은 포트폴리오와 벤치마크 사이의 추적 오류를 일정 수준 이내로 해야 한다거나, 개별 주식에 할당된 최대 비중을 10% 정도로 맞춰야 한다던가 하는 것들이 있습니다.

(# 부록 : 펀더멘털 팩터 모델과 이코노믹 팩터 모델의 수학적 동질성)

### Z-Score로 주식 선별하고 순위를 지정

많은 퀀트 운용역은 기대수익률와 위험을 숫자로 정확히 환산 하지 않고 상대 순위를 매기거나 절대 조건을 입력하여 주식을 단순히 선별합니다. 사실 실무에서는 더 많이 사용되는 유형입니다. 이 파트는 중요하므로 뒤에 더 자세하게 알아볼 것입니다. 다만 개념이 매우 단순하므로 살짝 살펴보도록 하겠습니다.
실무에서 펀더멘털 팩터 모델을 더 많이 사용한다고 표현 했는지 이해하게 될 것입니다.

Z스코어를 얻으려면 모든 주식의 팩터 노출도를 알아야 합니다. B/P, E/P, Size등이 펀더멘털 팩터 모델에서의 팩터 노출도 입니다.
그런 다음 각 주식에 대해 개별 팩터 노출도에서 유니버스의 평균 팩터 노출도를 빼고 그 차이를 유니버스 주식들간의 팩터 노출도의 표준편차로 나눕니다.

예를들어 B/P 비율에 대한 노출에 대한 Z스코어를 계산한다고 가정하겠습니다.
$\beta_1, beta_2, ..., beta_n$이 N개 주식들의 B/P 값입니다. Z스코어는 다음과 같이 정의됩니다.

$$z_i = {{\beta_i-\mu}\over{\sigma}}$$

여기서 $\mu$는 B/P의 평균, $\sigma$는 B/P의 표준편차입니다.

만약 어떤 주식 i의 Z스코어값 $Z_i$가 2 이면 이 주식의 B/P 비율은 평균에서 2 표준편차가 떨어져 있을 정도로 높다는 뜻입니다.

지금은 단일 팩터만 모델링 했지만 여려 팩터에 대한 Z스코어가 주어지는게 더 일반적입니다. 
나중에 더 자세하게 살펴 보겠습니다.

일단 중간 정리로 펀더멘털 팩터 모델과 이코노믹 팩터 모델 둘중에 무엇을 사용할지에 대한 가이드를 정리해 봤습니다.

![](/pic/2023-08-19-11-33-44.png)

1. 일단 이론적 엄밀성 측면에서 이코노믹 팩터 모델이 펀더멘털 팩터 모델에 비해 우수합니다. 경제 이론에 따르면 높은 기대 수익은 추가로 위험을 감수한 대가로만 정당화 됩니다 소형주와 가치주의 수익률이 높은 것은 그 주식들이 특별하게 더 좋은 특성이 있어서 그런것이 아니라 소형주와 가치주가 가진 특성이 위험을 증가시키기 때문에 프리미엄을 제공하는 것 뿐이라는 뜻입니다. 이런 경우 펀더멘털 팩터 모델은 위험의 원인과 주가에 미치는 영향에 대한 의미있는 해석을 하지 못합니다. 이코노믹 팩터 모델은 주식의 민감도 측정을 통해 해석이 가능합니다.

2. 펀더멘털 팩터 모델은 B/P와 GDP를 결합할 수 없지만 이코노믹 팩터 모델은 가능합니다.

3. 펀더멘털 팩터 모델은 이코노믹 팩터 모델에 비해 구현이 용이합니다.

4. 많은 주식들을 통해 계산하는 펀더멘털 팩터 모델에 비해 이코노믹 팩터모델은 좀더 장기간의 시계열 데이터가 필요합니다. 펀더멘털 팩터 모델은 극단적으로는 한 시점의 데이터만을 사용해서 기대수익률을 추정할 수도 있습니다. 이코노믹 팩터 모델과 펀더멘털 팩터 모델 둘다 많은 주식에 대한 데이터가 필요합니다. 상대적으로 펀더멘털 팩터 모델이 요구하는 데이터의 양이 더 적어 집니다.

5. 가장 좋은 모델은 상식이 통하고 평이한 언어로 충분히 설명하기 쉬운 모델입니다. 포트폴리오 운용자는 항상 자신이 사용하는 모델을 이해하고 고객에서 설명해야 합니다. 제아무리 훌륭한 모델이라도 이를 이해하지 못한 투자자가 사용하면 위험합니다.

## 마치며

여기서는 퀀트 포트폴리오 운용자가 주식 수익률을 예측하는 데 사용하는 기본 모델의 구조와 과정을 소개 했습니다. 펀더멘털 팩터 모델과 이코노믹 팩터 모델에 대한 소개와 특징을 언급했습니다. 이번 파트는 앞으로 좀 더 깊게 살펴볼 내용의 개괄에 가깝습니다.
이후 파트에서 각 내용들을 좀 더 자세히 검토할 것입니다.